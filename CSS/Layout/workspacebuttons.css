/*
Workspace Buttons Styling
version 2026.01.19
Styles for custom workspace quick-switch buttons injected into tab-strip
See: https://vivaldi.com/blog/how-to/pawel-shows-you-how-to-play-with-workspaces-and-custom-icons-in-vivaldi/
*/

/* Vivaldi's native workspace button hover effect */
.toolbar-tabbar-after button.ToolbarButton-Button[title*="workspace"]:hover,
.toolbar-tabbar-after button.ToolbarButton-Button[title*="Workspace"]:hover {
  background: rgba(255, 255, 255, 0.1);
  border-radius: calc(var(--radius, 8px) * 0.7);
  transition: background var(--fast-animation-speed) ease;
}

/* Workspace button full width in sidebar */
.tabbar-workspace-button {
  width: 100% !important;
}

/* Workspace popup styling - default solid background */
.WorkspacePopup,
div[class*="WorkspacePopup"] {
  position: relative;
  z-index: var(--z-overlay) !important;
  background: var(--colorBg, #1e1e1e) !important;
  background-color: var(--colorBg, #1e1e1e) !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  opacity: 1 !important;
}

/* When transparent tabbar is enabled, match transparency */
/* Use body.transparent-tabbar since popup may be at document root */
body.transparent-tabbar .WorkspacePopup,
body.transparent-tabbar div[class*="WorkspacePopup"],
.transparent-tabbar .WorkspacePopup,
.transparent-tabbar div[class*="WorkspacePopup"] {
  background: var(--colorBgAlpha, rgba(30, 30, 30, 0.85)) !important;
  background-color: var(--colorBgAlpha, rgba(30, 30, 30, 0.85)) !important;
  backdrop-filter: blur(16px) saturate(180%) !important;
  -webkit-backdrop-filter: blur(16px) saturate(180%) !important;
}

.WorkspacePopup > *,
div[class*="WorkspacePopup"] > * {
  background: transparent !important;
}

.WorkspacePopup-Items {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.WorkspacePopup-Items::-webkit-scrollbar {
  display: none;
}

/* Suppress pinned tab hover effects when workspace popup is open */
body:has(.WorkspacePopup) #tabs-container .tab-strip .is-pinned .tab-wrapper {
  z-index: var(--z-base) !important;
  pointer-events: none;
}

body:has(.WorkspacePopup) #tabs-container .tab-strip .is-pinned .tab-wrapper:hover {
  width: auto !important;
  min-height: auto !important;
  background-color: transparent !important;
}

/* Suppress auto-hide toolbar items when workspace popup is open */
body:has(.WorkspacePopup) .toolbar.toolbar-tabbar-before > *:not(.UrlBar-AddressField) {
  opacity: 0 !important;
  pointer-events: none !important;
  z-index: var(--z-base) !important;
}

/* ============================================ */
/* Stacking Context Fix for Popup Z-Index      */
/* ============================================ */

/*
 * When transparent tabbar is enabled, #tabs-tabbar-container gets backdrop-filter
 * which creates a new stacking context. This causes everything inside it (pinned
 * tabs, toolbar items) to paint as one unit, potentially covering the popup.
 *
 * Solution: Lower the CONTAINER's z-index when popup is open, not individual items.
 * This makes the entire stacking context paint below the popup.
 */
body:has(.WorkspacePopup) #tabs-tabbar-container {
  z-index: auto !important;
}

/* Also suppress the toolbar row when popup is open */
body:has(.WorkspacePopup) .toolbar.toolbar-tabbar-before {
  z-index: auto !important;
}

/* Ensure popup stays above by giving it a reasonable but not extreme z-index */
/* Note: Don't use extreme values like 2000000000 - causes other issues */
.WorkspacePopup {
  z-index: var(--z-popup, 400) !important;
}
